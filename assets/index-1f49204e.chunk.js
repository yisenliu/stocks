import{e as _,g as M,b as p,j as I,r as g,F as R}from"./vendor-262f8ba3.chunk.js";import{u as B,S as L,H as O,b as z,C as A}from"./Tab-bab14ce8.chunk.js";import{c as G,L as T,E as U}from"./404-374073c5.js";import{h as f}from"./moment-e953ecbf.chunk.js";var N={exports:{}},S={exports:{}},w={exports:{}},V;function J(){return V||(V=1,function(u,y){(function(i,s){u.exports=s()})(_,function(){function i(o,t,e){var r=(t-o)/e,n=!(r%.5)&&r%1,a=n?e:0;return a+(t-e*Math.round(r))}var s=i;return s})}(w)),w.exports}var E;function Q(){return E||(E=1,function(u,y){(function(i,s){u.exports=s(J())})(_,function(i){function s(t,e,r,n){if(t===e)return 0;if(t>e){var a=t;t=e,e=a}e--;var c=i(t,r,n);return c-t<0&&(c+=n),c-t>e-t?0:1+parseInt((e-c)/n)}var o=s;return o})}(S)),S.exports}(function(u,y){(function(i,s){u.exports=s(Q())})(_,function(i){function s(t){return t=+t,t>0?1:-1}var o={weekDays:function(e,r){var n=void 0,a=void 0,c=r.isBefore(e);c?(n=r,a=e):(n=e,a=r);var l=n.day(),d=Math.abs(a.diff(n,"days")),D=i(l,d+l,0,7),b=i(l,d+l,6,7),v=c?-1:1;return v*(d-(b+D))},weekendDays:function(e,r){var n=r.diff(e,"days"),a=this.weekDays(e,r);return n-a},addWeekDays:function(e,r){if(r===0||isNaN(r))return e;var n=s(r),a=e.day(),c=Math.abs(r),l=0;(a===0&&n===-1||a===6&&n===1)&&(l=1);var d=c;a!==0&&a!==6&&n>0?d+=a:a!==0&&a!==6&&n<0&&(d+=6-a);var D=Math.max(Math.floor(d/5)-1,0)+(d>5&&d%5>0?1:0);return l+=c+D*2,e.add(n*l,"days"),e},subtractWeekDays:function(e,r){return this.addWeekDays(e,-r)},isWeekDay:function(e){return e.isoWeekday()<6},isWeekendDay:function(e){return e.isoWeekday()>5}};return o})})(N);var X=N.exports;const Z=M(X);function $({options:u,currentIdx:y,onChange:i}){return p("div",{"data-name":"duration_picker",className:"flex -mx-4 -mb-4",children:u.map(({text:s},o)=>I("label",{className:"flex-1 py-2 text-center cursor-pointer border-b-3 "+(o===y?"border-white text-white":"border-transparent text-primary"),children:[p("input",{type:"radio",name:"duration",id:"",value:o,onChange:i,defaultChecked:o===y,className:"!hidden"}),s]},s))})}function K({dataset:u,data_id:y=null,token:i=null,start_date:s=f().subtract(5,"year").format("YYYY-MM-DD"),end_date:o=f().format("YYYY-MM-DD")}){const t={dataset:u,data_id:y,token:i,start_date:s,end_date:o};for(const[n,a]of Object.entries(t))a||delete t[n];const e=G(t);return B({url:"https://corsproxy.io/?"+encodeURIComponent("https://api.finmindtrade.com/api/v4/data"+e),timeout:8e3,headers:{"content-type":"application/x-www-form-urlencoded"}},[y,u])}const C=[{startDate:f().subtract(f().dayOfYear()-1,"days"),text:"YTD"},{startDate:f().subtract(1,"months"),text:"1月"},{startDate:f().subtract(2,"months"),text:"3月"},{startDate:f().subtract(6,"months"),text:"6月"},{startDate:f().subtract(1,"years"),text:"1年"},{startDate:f().subtract(3,"years"),text:"3年"},{startDate:f().subtract(5,"years"),text:"5年"}];function ne({dataset:u,data_id:y,closeKey:i,maxKey:s,minKey:o,token:t,tooltipValueLabel:e}){const[r,n]=g.useState(parseInt(localStorage.getItem("current_duration_idx"))||0),[a,c]=g.useState({min:null,max:null}),{data:l,error:d,stage:D}=K({dataset:u,data_id:y,token:t}),b=l||[],v=b.length,j=Z.weekDays(C[r].startDate,f()),H=C[r].text,k=v-j,m=g.useMemo(()=>b.slice(k>0?k:0,v),[k]),q=v>0;function F(x){const h=parseInt(x.target.value);n(h),localStorage.setItem("current_duration_idx",h)}return g.useEffect(()=>{let x=null,h=null;m.forEach(W=>{const P=W[s],Y=W[o];(!h||P>h)&&(h=P),(!x||Y<x)&&(x=Y)}),c({min:x,max:h})},[q,r]),p(A,{in:m.length>0,collapsedSize:90,children:I(z,{"data-name":"price_history",className:"text-center",children:[D==="fetching"&&p(T,{}),d&&p(U,{children:d.message}),m.length>0&&I(R,{children:[p(L,{currentDurationLabel:H,currentValue:m[m.length-1][s],startValue:m[0][s],endDate:m[m.length-1].date,min:a.min,max:a.max}),p(O,{history:m,closeKey:i,tooltipValueLabel:e}),p($,{options:C,currentIdx:r,onChange:F})]})]})})}export{ne as H};
